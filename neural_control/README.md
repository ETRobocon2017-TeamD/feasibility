# neural_control
## ファイル説明
* balance_test.py  
    ロボットでバランス制御する
* network.pickle  
    ニューラルネットのパラメータ
* train_server.py  
    TCPServerを立ち上げ、ロボットから受信したデータをもとに学習する

## 動かし方
サーバーサイド
```sh
sudo firewall-cmd --add-port=8888/tcp

pip install numpy
```
```sh
python3 train_server.py
```

ロボット
```
python3 balance_test.py
```

## ロボットの動作
ロボット起動時にジャイロのキャリブレーションを行う。
手で支えながらだと手ブレによる角速度によって[ドリフトが起きる](https://garchiving.com/gyro-drift-correction/)ようなので、うつ伏せに倒した状態で起動する。

高い音(800Hz)でピーとなったらキャリブレーション完了。
コンソールに現在の角度が出力されるので、これが変化せずに0, 0, 0...と出力されることを確認する。
※失敗してると1, 2, 3, ...という感じで動かしてないのに角度が変化する

倒れているときにスイッチを押すと再度キャリブレーションができる。

キャリブレーション後にロボットを垂直に起こすと「ピ、ピ、ピ、ピー↑」と音がなり、倒立制御を開始する。
倒立制御開始後に20度以上傾くと倒立制御を終了する（「ピピ」）。その後もう一回キャリブレーションをして起こすとまた倒立制御を試すことができる。

倒れた直後にサーバーと通信するので、この時点でtrain_server.pyを起動していること。
